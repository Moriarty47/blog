import{L as $,s as m}from"./app-bf7bc9cc.js";var u={};Object.defineProperty(u,"__esModule",{value:!0});function d(t,r,e){var o;if(e===void 0&&(e={}),!r.codes){r.codes={};for(var s=0;s<r.chars.length;++s)r.codes[r.chars[s]]=s}if(!e.loose&&t.length*r.bits&7)throw new SyntaxError("Invalid padding");for(var i=t.length;t[i-1]==="=";)if(--i,!e.loose&&!((t.length-i)*r.bits&7))throw new SyntaxError("Invalid padding");for(var b=new((o=e.out)!=null?o:Uint8Array)(i*r.bits/8|0),a=0,n=0,c=0,f=0;f<i;++f){var y=r.codes[t[f]];if(y===void 0)throw new SyntaxError("Invalid character "+t[f]);n=n<<r.bits|y,a+=r.bits,a>=8&&(a-=8,b[c++]=255&n>>a)}if(a>=r.bits||255&n<<8-a)throw new SyntaxError("Unexpected end of data");return b}function l(t,r,e){e===void 0&&(e={});for(var o=e,s=o.pad,i=s===void 0?!0:s,b=(1<<r.bits)-1,a="",n=0,c=0,f=0;f<t.length;++f)for(c=c<<8|255&t[f],n+=8;n>r.bits;)n-=r.bits,a+=r.chars[b&c>>n];if(n&&(a+=r.chars[b&c<<r.bits-n]),i)for(;a.length*r.bits&7;)a+="=";return a}var v={chars:"0123456789ABCDEF",bits:4},h={chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bits:5},E={chars:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bits:5},g={chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bits:6},S={chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bits:6},x={parse:function(r,e){return d(r.toUpperCase(),v,e)},stringify:function(r,e){return l(r,v,e)}},K={parse:function(r,e){return e===void 0&&(e={}),d(e.loose?r.toUpperCase().replace(/0/g,"O").replace(/1/g,"L").replace(/8/g,"B"):r,h,e)},stringify:function(r,e){return l(r,h,e)}},R={parse:function(r,e){return d(r,E,e)},stringify:function(r,e){return l(r,E,e)}},P={parse:function(r,e){return d(r,g,e)},stringify:function(r,e){return l(r,g,e)}},A={parse:function(r,e){return d(r,S,e)},stringify:function(r,e){return l(r,S,e)}},O={parse:d,stringify:l};u.base16=x;u.base32=K;u.base32hex=R;u.base64=P;u.base64url=A;u.codec=O;u.base16;u.base32;u.base32hex;const C=u.base64;u.base64url;u.codec;async function B(t,r,e,o=!1){const[,s,i]=t.match(/^\[data-i=(\d+)\](.*)/),b=Number(s),a=o?$(r):r;return new Promise((n,c)=>{I(a,i,b,e).then(f=>{n(o?{pswd:a,content:f}:f)}).catch(c)})}function p(){var t,r;if(!window||!window.crypto||!globalThis.crypto)throw new Error("[EncryptPlugin] ERROR: decrypt should be used in browser env.");return((t=window.crypto)==null?void 0:t.subtle)||((r=window.crypto)==null?void 0:r.webkitSubtle)}const w="dc__derived__k__";async function I(t,r,e,o){const s=C.parse(r),i=s.slice(0,32),b=s.slice(32,32+16),a=s.slice(32+16);await m(200);const n=$(t);return new Promise((c,f)=>{M({salt:i,iv:b,ciphertext:a,iterations:e},n,o).then(c).catch(()=>{const y=`${w}${o}`;sessionStorage[y]&&sessionStorage.removeItem(y),f(new Error("[EncryptPlugin] ERROR: Wrong password!"))})})}async function U(t,r,e){const o=new TextEncoder,s=p(),i=await s.importKey("raw",o.encode(r),"PBKDF2",!1,["deriveKey"]);return await s.deriveKey({name:"PBKDF2",salt:t,iterations:e,hash:"SHA-256"},i,{name:"AES-GCM",length:256},!0,["decrypt"])}async function _(t){return p().importKey("jwk",t,"AES-GCM",!0,["decrypt"])}const D=t=>sessionStorage[`${w}${t}`];async function M({salt:t,iv:r,ciphertext:e,iterations:o},s,i){const b=new TextDecoder,a=sessionStorage[`${w}${i}`]?await _(JSON.parse(sessionStorage[`${w}${i}`])):await U(t,s,o),n=p(),c=new Uint8Array(await n.decrypt({name:"AES-GCM",iv:r},a,e));if(!c)throw new Error("[EncryptPlugin] ERROR: Malformed data");return sessionStorage[`${w}${i}`]=JSON.stringify(await n.exportKey("jwk",a)),b.decode(c)}export{B as d,D as g};
